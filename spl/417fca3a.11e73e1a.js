(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{145:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return i})),a.d(t,"metadata",(function(){return l})),a.d(t,"rightToc",(function(){return s})),a.d(t,"default",(function(){return c}));var n=a(2),r=a(9),o=(a(0),a(155)),i={title:"Feature Proposal Program"},l={id:"feature-proposal",isDocsHomePage:!1,title:"Feature Proposal Program",description:"The Feature Proposal Program provides a workflow for activation of Solana",source:"@site/src/feature-proposal.md",permalink:"/solana-program-library/spl/feature-proposal",sidebar:"docs",previous:{title:"Stake Pool Program",permalink:"/solana-program-library/spl/stake-pool"}},s=[{value:"Background",id:"background",children:[]},{value:"Source",id:"source",children:[]},{value:"Interface",id:"interface",children:[]},{value:"Command-line Utility",id:"command-line-utility",children:[{value:"Configuration",id:"configuration",children:[]}]},{value:"Feature Proposal Life Cycle",id:"feature-proposal-life-cycle",children:[{value:"Implement the Feature",id:"implement-the-feature",children:[]},{value:"Initiate the Feature Proposal",id:"initiate-the-feature-proposal",children:[]},{value:"Tally the Votes",id:"tally-the-votes",children:[]}]}],p={rightToc:s};function c(e){var t=e.components,a=Object(r.a)(e,["components"]);return Object(o.b)("wrapper",Object(n.a)({},p,a,{components:t,mdxType:"MDXLayout"}),Object(o.b)("p",null,"The Feature Proposal Program provides a workflow for activation of Solana\nnetwork features through community vote based on validator stake weight."),Object(o.b)("p",null,"Community voting is accomplished using ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"/solana-program-library/spl/token"}),"SPL Tokens"),".  Tokens are\nminted that represent the total active stake on the network, and distributed to\nall validators based on their stake.  Validators vote for feature activation by\ntransferring their vote tokens to a predetermined address.  Once the vote\nthreshold is met the feature is activated."),Object(o.b)("h2",{id:"background"},"Background"),Object(o.b)("p",null,"The Solana validator software supports runtime feature activation through the\nbuilt-in ",Object(o.b)("inlineCode",{parentName:"p"},"Feature")," program.  This program ensures that features are activated\nsimultaneously across all validators to avoid divergent behavior that would\ncause hard forks or otherwise break consensus."),Object(o.b)("p",null,"The\n",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"https://docs.rs/solana-program/latest/solana_program/feature/index.html"}),"feature"),"\nand ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"https://docs.rs/solana-sdk/latest/solana_sdk/feature_set/index.html"}),"feature_set"),"\nRust modules are the primitives for this facility, and the ",Object(o.b)("inlineCode",{parentName:"p"},"solana feature"),"\ncommand-line subcommands allow for easy feature status inspection and feature\nactivation."),Object(o.b)("p",null,"The ",Object(o.b)("inlineCode",{parentName:"p"},"solana feature activate")," workflow was designed for use by the core Solana\ndevelopers to allow for low-overhead addition of non-controversial network\nfeatures over time."),Object(o.b)("p",null,"The Feature Proposal Program provides an additional mechanism over these runtime\nfeature activation primitives to permit feature activation by community vote\nwhen appropriate."),Object(o.b)("h2",{id:"source"},"Source"),Object(o.b)("p",null,"The Feature Proposal Program's source is available on\n",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/solana-labs/solana-program-library"}),"github")),Object(o.b)("h2",{id:"interface"},"Interface"),Object(o.b)("p",null,"The Feature Proposal Program is written in Rust and available on ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"https://crates.io/crates/spl-feature-proposal"}),"crates.io")," and ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"https://docs.rs/spl-feature-proposal"}),"docs.rs"),"."),Object(o.b)("h2",{id:"command-line-utility"},"Command-line Utility"),Object(o.b)("p",null,"The ",Object(o.b)("inlineCode",{parentName:"p"},"spl-feature-proposal")," command-line utility can be used to manage feature\nproposal.  Once you have ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"https://rustup.rs/"}),"Rust installed"),", run:"),Object(o.b)("pre",null,Object(o.b)("code",Object(n.a)({parentName:"pre"},{className:"language-sh"}),"$ cargo install spl-feature-proposal-cli\n")),Object(o.b)("p",null,"Run ",Object(o.b)("inlineCode",{parentName:"p"},"spl-feature-proposal --help")," for a full description of available commands."),Object(o.b)("h3",{id:"configuration"},"Configuration"),Object(o.b)("p",null,"The ",Object(o.b)("inlineCode",{parentName:"p"},"spl-feature-proposal")," configuration is shared with the ",Object(o.b)("inlineCode",{parentName:"p"},"solana")," command-line tool."),Object(o.b)("h2",{id:"feature-proposal-life-cycle"},"Feature Proposal Life Cycle"),Object(o.b)("p",null,"This section describes the life cycle of a feature proposal."),Object(o.b)("h3",{id:"implement-the-feature"},"Implement the Feature"),Object(o.b)("p",null,"The first step is to conceive of the new feature and realize it in the\nSolana code base, working with the core Solana developers at ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/solana-labs/solana"}),"https://github.com/solana-labs/solana"),"."),Object(o.b)("p",null,"During the implementation, a ",Object(o.b)("em",{parentName:"p"},"feature id")," will be required to identity the new\nfeature in the code base to avoid the new functionality until its activation.\nThe ",Object(o.b)("em",{parentName:"p"},"feature id")," for a feature proposal is derived by running the following\ncommands."),Object(o.b)("p",null,"First create a keypair for the proposal:"),Object(o.b)("pre",null,Object(o.b)("code",Object(n.a)({parentName:"pre"},{}),"$ solana-keygen new --outfile feature-proposal.json --silent --no-passphrase\nWrote new keypair to feature-proposal.json\n")),Object(o.b)("p",null,"Now run the ",Object(o.b)("inlineCode",{parentName:"p"},"spl-feature-proposal")," program to derive the ",Object(o.b)("em",{parentName:"p"},"feature id"),":"),Object(o.b)("pre",null,Object(o.b)("code",Object(n.a)({parentName:"pre"},{}),"$ spl-feature-proposal address feature-proposal.json\nFeature Id: HQ3baDfNU7WKCyWvtMYZmi51YPs7vhSiLn1ESYp3jhiA\nToken Mint Address: ALvA7Lv9jbo8JFhxqnRpjWWuR3aD12uCb5KBJst4uc3d\nAcceptance Token Address: AdqKm3mSJf8AtTWjfpA5ZbJszWQPcwyLA2XkRyLbf3Di\n")),Object(o.b)("p",null,"which in this case is ",Object(o.b)("inlineCode",{parentName:"p"},"HQ3baDfNU7WKCyWvtMYZmi51YPs7vhSiLn1ESYp3jhiA"),"."),Object(o.b)("p",null,Object(o.b)("inlineCode",{parentName:"p"},"HQ3baDfNU7WKCyWvtMYZmi51YPs7vhSiLn1ESYp3jhiA")," is the identifier that will be\nused in the code base and eventually will be visible in the ",Object(o.b)("inlineCode",{parentName:"p"},"solana feature status")," command."),Object(o.b)("p",null,"Note however that it is not possible to use ",Object(o.b)("inlineCode",{parentName:"p"},"solana feature activate")," to\nactivate this feature, as there is no private key for\n",Object(o.b)("inlineCode",{parentName:"p"},"HQ3baDfNU7WKCyWvtMYZmi51YPs7vhSiLn1ESYp3jhiA"),".  Activation of this feature is\nonly possible by the Feature Proposal Program."),Object(o.b)("h3",{id:"initiate-the-feature-proposal"},"Initiate the Feature Proposal"),Object(o.b)("p",null,"After the feature is implemented and deployed to the Solana cluster,\nthe ",Object(o.b)("em",{parentName:"p"},"feature id")," will be visible in ",Object(o.b)("inlineCode",{parentName:"p"},"solana feature status")," and the ",Object(o.b)("em",{parentName:"p"},"feature\nproposer")," may initiate the community proposal process."),Object(o.b)("p",null,"This is done by running:"),Object(o.b)("pre",null,Object(o.b)("code",Object(n.a)({parentName:"pre"},{}),"$ spl-feature-proposal propose feature-proposal.json\nFeature Id: HQ3baDfNU7WKCyWvtMYZmi51YPs7vhSiLn1ESYp3jhiA\nToken Mint Address: ALvA7Lv9jbo8JFhxqnRpjWWuR3aD12uCb5KBJst4uc3d\nDistributor Token Address: GK55hNft4TGc3Hg4KzbjEmju8VfaNuXK8jQNDTZKcsNF\nAcceptance Token Address: AdqKm3mSJf8AtTWjfpA5ZbJszWQPcwyLA2XkRyLbf3Di\nNumber of validators: 376\nTokens to be minted: 134575791.53064314\nTokens required for acceptance: 90165780.3255309 (67%)\nToken distribution file: feature-proposal.csv\nJSON RPC URL: http://api.mainnet-beta.solana.com\n\nDistribute the proposal tokens to all validators by running:\n    $ solana-tokens distribute-spl-tokens --from GK55hNft4TGc3Hg4KzbjEmju8VfaNuXK8jQNDTZKcsNF --input-csv feature-proposal.csv --db-path db.8CyUVvio --fee-payer ~/.config/solana/id.json --owner <FEATURE_PROPOSAL_KEYPAIR>\n    $ solana-tokens spl-token-balances --mint ALvA7Lv9jbo8JFhxqnRpjWWuR3aD12uCb5KBJst4uc3d --input-csv feature-proposal.csv\n\nOnce the distribution is complete, request validators vote for the proposal. To vote, validators should first look up their token account address:\n    $ spl-token --owner ~/validator-keypair.json accounts ALvA7Lv9jbo8JFhxqnRpjWWuR3aD12uCb5KBJst4uc3d\nand then submit their vote by running:\n    $ spl-token --owner ~/validator-keypair.json transfer <TOKEN_ACCOUNT_ADDRESS> ALL AdqKm3mSJf8AtTWjfpA5ZbJszWQPcwyLA2XkRyLbf3Di\n\nPeriodically the votes must be tallied by running:\n  $ spl-feature-proposal tally 8CyUVvio2oYAP28ZkMBPHq88ikhRgWet6i4NYsCW5Cxa\nTallying is permissionless and may be run by anybody.\nOnce this feature proposal is accepted, the HQ3baDfNU7WKCyWvtMYZmi51YPs7vhSiLn1ESYp3jhiA feature will be activated at the next epoch.\n\nAdd --confirm flag to initiate the feature proposal\n")),Object(o.b)("p",null,"If the output looks good run the command again with the ",Object(o.b)("inlineCode",{parentName:"p"},"--confirm")," flag to\ncontinue, and then follow the remaining steps in the output to distribute the\nvote tokens to all the validators."),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"COST:")," As a part of token distribution, the ",Object(o.b)("em",{parentName:"p"},"feature proposer")," will be\nfinancing the creation of SPL Token accounts for each of the validators.  A SPL\nToken account requires 0.00203928 SOL at creation, so the cost for initiating a\nfeature proposal on a network with 500 validators is approximately 1 SOL."),Object(o.b)("h3",{id:"tally-the-votes"},"Tally the Votes"),Object(o.b)("p",null,"After advertising to the validators that a feature proposal is pending their\nacceptance, the votes are tallied by running:"),Object(o.b)("pre",null,Object(o.b)("code",Object(n.a)({parentName:"pre"},{}),"$ spl-feature-proposal tally 8CyUVvio2oYAP28ZkMBPHq88ikhRgWet6i4NYsCW5Cxa\n")),Object(o.b)("p",null,"Anybody may tally the vote.  Once the required number of votes are tallied, the\nfeature will be automatically activated at the start of the next epoch."),Object(o.b)("p",null,"Upon a successful activation the feature will now show as activated by\n",Object(o.b)("inlineCode",{parentName:"p"},"solana feature status")," as well."))}c.isMDXComponent=!0},155:function(e,t,a){"use strict";a.d(t,"a",(function(){return u})),a.d(t,"b",(function(){return f}));var n=a(0),r=a.n(n);function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var p=r.a.createContext({}),c=function(e){var t=r.a.useContext(p),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},u=function(e){var t=c(e.components);return r.a.createElement(p.Provider,{value:t},e.children)},b={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},d=r.a.forwardRef((function(e,t){var a=e.components,n=e.mdxType,o=e.originalType,i=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),u=c(a),d=n,f=u["".concat(i,".").concat(d)]||u[d]||b[d]||o;return a?r.a.createElement(f,l(l({ref:t},p),{},{components:a})):r.a.createElement(f,l({ref:t},p))}));function f(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=a.length,i=new Array(o);i[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:n,i[1]=l;for(var p=2;p<o;p++)i[p]=a[p];return r.a.createElement.apply(null,i)}return r.a.createElement.apply(null,a)}d.displayName="MDXCreateElement"}}]);